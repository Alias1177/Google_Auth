name: Deploy Google_Auth

on:
  push:
    branches:
      - main # –∑–∞–ø—É—Å–∫–∞—Ç—å workflow –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø—É—à–∞ –≤ –≤–µ—Ç–∫—É main ‚úÖ

jobs:
  deploy:
    runs-on: ubuntu-latest # –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–µ—Ä GitHub —Å Ubuntu

    steps:
      - name: Checkout code üõéÔ∏è
        uses: actions/checkout@v4

      # –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∏ —Ä–∞–±–æ—á–∏–π —à–∞–≥. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–∞ v0.9.0
      - name: Setup SSH Agent üîë
        uses: webfactory/ssh-agent@v0.9.0
        with:
          ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }}

      - name: üöÄ Deploy code to server
        run: |
          ssh -o StrictHostKeyChecking=no ${{ secrets.SERVER_USER }}@${{ secrets.SERVER_IP }} << EOF
            cd ~/Google_Auth
            git pull origin main
            docker-compose down
            docker-compose up -d --build
          EOF